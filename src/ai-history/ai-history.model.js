// create model for the game
// {
//     "ok": true,
//     "msg": "se creo el juego",
//     "formatAnimeSelected": {
//         "mal_id": 11757,
//         "title": "Sword Art Online",
//         "synopsis": "Ever since the release of the innovative NerveGear, gamers from all around the globe have been given the opportunity to experience a completely immersive virtual reality. Sword Art Online (SAO), one of the most recent games on the console, offers a gateway into the wondrous world of Aincrad, a vivid, medieval landscape where users can do anything within the limits of imagination. With the release of this worldwide sensation, gaming has never felt more lifelike.\n\nHowever, the idyllic fantasy rapidly becomes a brutal nightmare when SAO's creator traps thousands of players inside the game. The \"log-out\" function has been removed, with the only method of escape involving beating all of Aincrad's one hundred increasingly difficult levels. Adding to the struggle, any in-game death becomes permanent, ending the player's life in the real world.\n\nWhile Kazuto \"Kirito\" Kirigaya was fortunate enough to be a beta-tester for the game, he quickly finds that despite his advantages, he cannot overcome SAO's challenges alone. Teaming up with Asuna Yuuki and other talented players, Kirito makes an effort to face the seemingly insurmountable trials head-on. But with difficult bosses and threatening dark cults impeding his progress, Kirito finds that such tasks are much easier said than done.\n\n[Written by MAL Rewrite]",
//         "characters": [
//             {
//                 "mal_id": 36765,
//                 "url": "https://myanimelist.net/character/36765/Kazuto_Kirigaya",
//                 "images": {
//                     "jpg": {
//                         "image_url": "https://cdn.myanimelist.net/images/characters/7/204821.jpg?s=6a96a832b35d0ff3af9292bdb082546e"
//                     },
//                     "webp": {
//                         "image_url": "https://cdn.myanimelist.net/images/characters/7/204821.webp?s=6a96a832b35d0ff3af9292bdb082546e",
//                         "small_image_url": "https://cdn.myanimelist.net/images/characters/7/204821t.webp?s=6a96a832b35d0ff3af9292bdb082546e"
//                     }
//                 },
//                 "name": "Kirigaya, Kazuto"
//             },
//             {
//                 "mal_id": 36831,
//                 "url": "https://myanimelist.net/character/36831/Suguha_Kirigaya",
//                 "images": {
//                     "jpg": {
//                         "image_url": "https://cdn.myanimelist.net/images/characters/9/192515.jpg?s=61eedc4ceb95b186ae903a1e00e2bbea"
//                     },
//                     "webp": {
//                         "image_url": "https://cdn.myanimelist.net/images/characters/9/192515.webp?s=61eedc4ceb95b186ae903a1e00e2bbea",
//                         "small_image_url": "https://cdn.myanimelist.net/images/characters/9/192515t.webp?s=61eedc4ceb95b186ae903a1e00e2bbea"
//                     }
//                 },
//                 "name": "Kirigaya, Suguha"
//             },
//             {
//                 "mal_id": 36828,
//                 "url": "https://myanimelist.net/character/36828/Asuna_Yuuki",
//                 "images": {
//                     "jpg": {
//                         "image_url": "https://cdn.myanimelist.net/images/characters/15/262053.jpg?s=449153df46cce80307c9f8ae622b4514"
//                     },
//                     "webp": {
//                         "image_url": "https://cdn.myanimelist.net/images/characters/15/262053.webp?s=449153df46cce80307c9f8ae622b4514",
//                         "small_image_url": "https://cdn.myanimelist.net/images/characters/15/262053t.webp?s=449153df46cce80307c9f8ae622b4514"
//                     }
//                 },
//                 "name": "Yuuki, Asuna"
//             },
//             {
//                 "mal_id": 72901,
//                 "url": "https://myanimelist.net/character/72901/Alicia_Rue",
//                 "images": {
//                     "jpg": {
//                         "image_url": "https://cdn.myanimelist.net/images/characters/14/187203.jpg?s=b88c5bcde7a9b5b010e3f80b3bea5694"
//                     },
//                     "webp": {
//                         "image_url": "https://cdn.myanimelist.net/images/characters/14/187203.webp?s=b88c5bcde7a9b5b010e3f80b3bea5694",
//                         "small_image_url": "https://cdn.myanimelist.net/images/characters/14/187203t.webp?s=b88c5bcde7a9b5b010e3f80b3bea5694"
//                     }
//                 },
//                 "name": "Alicia Rue"
//             },
//             {
//                 "mal_id": 66645,
//                 "url": "https://myanimelist.net/character/66645/Argo",
//                 "images": {
//                     "jpg": {
//                         "image_url": "https://cdn.myanimelist.net/images/characters/8/297087.jpg?s=17f9f95b9b0a926971ae4dcded53e089"
//                     },
//                     "webp": {
//                         "image_url": "https://cdn.myanimelist.net/images/characters/8/297087.webp?s=17f9f95b9b0a926971ae4dcded53e089",
//                         "small_image_url": "https://cdn.myanimelist.net/images/characters/8/297087t.webp?s=17f9f95b9b0a926971ae4dcded53e089"
//                     }
//                 },
//                 "name": "Argo"
//             }
//         ]
//     },
//     "text": {
//         "gameTitle": "Interactive RPG: Sword Art Online",
//         "introduction": "Bienvenido al mundo de Sword Art Online. Estás a punto de embarcarte en una aventura donde tus decisiones darán forma a la historia.",
//         "storySynopsis": "Desde el lanzamiento del innovador NerveGear, los jugadores de todo el mundo han tenido la oportunidad de experimentar una realidad virtual completamente inmersiva. Sword Art Online (SAO), uno de los juegos más recientes en la consola, ofrece una puerta de entrada al maravilloso mundo de Aincrad, un paisaje medieval vibrante donde los usuarios pueden hacer cualquier cosa dentro de los límites de la imaginación. Con el lanzamiento de esta sensación mundial, los juegos nunca se han sentido tan realistas. Sin embargo, la idílica fantasía rápidamente se convierte en una pesadilla brutal cuando el creador de SAO atrapa a miles de jugadores dentro del juego. La función de \"cerrar sesión\" se ha eliminado, y el único método de escape implica vencer los cien niveles cada vez más difíciles de Aincrad. Para agregar a la lucha, cualquier muerte en el juego se vuelve permanente, terminando la vida del jugador en el mundo real. Mientras que Kazuto \"Kirito\" Kirigaya tuvo la suerte de ser un beta-tester del juego, rápidamente descubre que a pesar de sus ventajas, no puede superar los desafíos de SAO solo. Haciendo equipo con Asuna Yuuki y otros jugadores talentosos, Kirito hace un esfuerzo por enfrentar los desafíos aparentemente insuperables de frente. Pero con jefes difíciles y amenazantes cultos oscuros que impiden su progreso, Kirito descubre que tales tareas son mucho más fáciles de decir que de hacer.",
//         "scenarios": [
//             {
//                 "sceneId": 1,
//                 "location": "Aincrad",
//                 "description": "Te encuentras en el primer piso de Aincrad, rodeado de otros jugadores. El aire es denso con una mezcla de emoción y miedo, ya que todos son conscientes del peligro que acecha en este mundo virtual.",
//                 "characters": [
//                     {
//                         "name": "Kirito",
//                         "image_url": "https://www.example.com/kirito.jpg",
//                         "dialogue": [
//                             {
//                                 "id": 1,
//                                 "text": "¡Hey, tú! ¿Estás preparado para la aventura?",
//                                 "options": [
//                                     {
//                                         "optionId": 1,
//                                         "text": "¡Claro que sí! Estoy listo para enfrentarme a cualquier desafío.",
//                                         "consequence": "Kirito te saluda con una sonrisa y te recomienda ir a la ciudad para buscar información sobre el siguiente nivel."
//                                     },
//                                     {
//                                         "optionId": 2,
//                                         "text": "La verdad estoy un poco asustado, pero tengo que hacerlo.",
//                                         "consequence": "Kirito te anima a no perder la esperanza y te sugiere que te unas a un grupo para sentirte más seguro."
//                                     }
//                                 ]
//                             }
//                         ]
//                     },
//                     {
//                         "name": "Asuna",
//                         "image_url": "https://www.example.com/asuna.jpg",
//                         "dialogue": [
//                             {
//                                 "id": 1,
//                                 "text": "Es bueno verte aquí. ¿Qué planes tienes para avanzar en este nivel?",
//                                 "options": [
//                                     {
//                                         "optionId": 1,
//                                         "text": "Todavía no lo tengo muy claro, ¿tú tienes algún plan?",
//                                         "consequence": "Asuna te propone unirse a su grupo, ya que necesita ayuda para derrotar a un jefe."
//                                     },
//                                     {
//                                         "optionId": 2,
//                                         "text": "Estoy buscando un grupo con el que poder avanzar.",
//                                         "consequence": "Asuna te recomienda unirse a un grupo de jugadores experimentados para aprender más sobre el juego."
//                                     }
//                                 ]
//                             }
//                         ]
//                     }
//                 ],
//                 "actions": [
//                     {
//                         "actionId": 1,
//                         "description": "Hablar con otros jugadores para encontrar un grupo.",
//                         "result": "Puedes encontrar un grupo con el que explorar el primer piso de Aincrad y aprender más sobre las mecánicas del juego.",
//                         "consequence": "Te unes a un grupo y comienzas a explorar Aincrad, descubriendo nuevos lugares y enfrentando tu primer encuentro con un enemigo."
//                     },
//                     {
//                         "actionId": 2,
//                         "description": "Explorar las calles de la ciudad.",
//                         "result": "Puedes encontrar un puesto de información donde te pueden indicar la ubicación del siguiente nivel.",
//                         "consequence": "Descubres que el siguiente nivel se encuentra en un bosque oscuro y peligroso. Decides si quieres enfrentarte a la amenaza de inmediato o buscar un grupo más fuerte para acompañarte."
//                     }
//                 ]
//             },
//             {
//                 "sceneId": 2,
//                 "location": "Bosque",
//                 "description": "Te encuentras en un bosque oscuro y misterioso, lleno de criaturas peligrosas. La atmósfera es opresiva, y el silencio solo se interrumpe por el sonido de tus pasos y el crujido de las hojas bajo tus pies.",
//                 "characters": [
//                     {
//                         "name": "Klein",
//                         "image_url": "https://www.example.com/klein.jpg",
//                         "dialogue": [
//                             {
//                                 "id": 1,
//                                 "text": "Cuidado, esta zona es muy peligrosa. Es mejor que vayamos juntos.",
//                                 "options": [
//                                     {
//                                         "optionId": 1,
//                                         "text": "¡Gracias! Me siento más tranquilo sabiendo que estoy acompañado.",
//                                         "consequence": "Klein te acompaña y te ayuda a superar las dificultades del bosque."
//                                     },
//                                     {
//                                         "optionId": 2,
//                                         "text": "No te preocupes, puedo cuidarme solo.",
//                                         "consequence": "Klein te advierte de los peligros del bosque, pero tú decides ir solo y te encuentras con un enemigo que te daña."
//                                     }
//                                 ]
//                             }
//                         ]
//                     }
//                 ],
//                 "actions": [
//                     {
//                         "actionId": 1,
//                         "description": "Buscar un camino seguro para atravesar el bosque.",
//                         "result": "Puedes encontrar un camino más seguro que te llevará al siguiente nivel sin tener que enfrentarte a muchos enemigos.",
//                         "consequence": "Encuentras un camino seguro y llegas al siguiente nivel sin mucho problema."
//                     },
//                     {
//                         "actionId": 2,
//                         "description": "Enfrentarte a los enemigos que se cruzan en tu camino.",
//                         "result": "Puedes obtener experiencia y objetos valiosos al derrotar a los enemigos.",
//                         "consequence": "Te enfrentas a varios enemigos en el bosque y te das cuenta de que la dificultad del juego aumenta notablemente. Decides si quieres seguir luchando o buscar un camino más seguro."
//                     }
//                 ]
//             },
//             {
//                 "sceneId": 3,
//                 "location": "Castillo",
//                 "description": "Te encuentras frente a un castillo imponente, el cual parece custodiado por una fuerza invisible que te impide avanzar. Las puertas del castillo están cerradas con llave, y no hay forma de entrar por la fuerza.",
//                 "characters": [
//                     {
//                         "name": "Agil",
//                         "image_url": "https://www.example.com/agil.jpg",
//                         "dialogue": [
//                             {
//                                 "id": 1,
//                                 "text": "Para entrar a este castillo, necesitas encontrar la llave.",
//                                 "options": [
//                                     {
//                                         "optionId": 1,
//                                         "text": "¿Dónde puedo encontrarla?",
//                                         "consequence": "Agil te explica que la llave está en manos de un grupo de jugadores llamado \"Los Guerreros Oscuros\"."
//                                     },
//                                     {
//                                         "optionId": 2,
//                                         "text": "¿Qué clase de grupo es ese?",
//                                         "consequence": "Agil te explica que Los Guerreros Oscuros son un grupo de jugadores que se dedican a robar y a causar problemas a los demás."
//                                     }
//                                 ]
//                             }
//                         ]
//                     }
//                 ],
//                 "actions": [
//                     {
//                         "actionId": 1,
//                         "description": "Buscar información sobre Los Guerreros Oscuros.",
//                         "result": "Puedes encontrar información sobre la ubicación de Los Guerreros Oscuros.",
//                         "consequence": "Localizas a Los Guerreros Oscuros y te enfrentas a ellos en un combate difícil, donde te pones a prueba para conseguir la llave."
//                     },
//                     {
//                         "actionId": 2,
//                         "description": "Buscar otra forma de entrar al castillo.",
//                         "result": "Puedes encontrar una entrada secreta que te permitirá acceder al castillo sin tener que luchar contra Los Guerreros Oscuros.",
//                         "consequence": "Encuentras una entrada secreta al castillo, pero te enfrentas a una trampa que te daña."
//                     }
//                 ]
//             }
//         ],
//         "playerChoices": {
//             "affectStory": true,
//             "choicesMade": []
//         }
//     }
// }

const { Schema, model } = require("mongoose");

const GameSchema = Schema({
  animeData: {
    mal_id: {
      type: Number,
      required: [true, "El id del anime es obligatorio"],
    },
    title: {
      type: String,
      required: [true, "El título del anime es obligatorio"],
    },
    synopsis: {
      type: String,
      required: [true, "La sinopsis del anime es obligatoria"],
    },
    characters: [
      {
        mal_id: {
          type: Number,
          required: [true, "El id del personaje es obligatorio"],
        },
        url: {
          type: String,
          required: [true, "La URL del personaje es obligatoria"],
        },
        images: {
          jpg: {
            image_url: {
              type: String,
              required: [
                true,
                "La URL de la imagen del personaje es obligatoria",
              ],
            },
          },
          webp: {
            image_url: {
              type: String,
              required: [
                true,
                "La URL de la imagen del personaje es obligatoria",
              ],
            },
            small_image_url: {
              type: String,
              required: [
                true,
                "La URL de la imagen del personaje es obligatoria",
              ],
            },
          },
        },
        name: {
          type: String,
          required: [true, "El nombre del personaje es obligatorio"],
        },
      },
    ],
  },
  gameTitle: {
    type: String,
    required: [true, "El título del juego es obligatorio"],
  },
  introduction: {
    type: String,
    required: [true, "La introducción del juego es obligatoria"],
  },
  storySynopsis: {
    type: String,
    required: [true, "La sinopsis del juego es obligatoria"],
  },
  scenarios: [
    {
      sceneId: {
        type: Number,
        required: [true, "El id de la escena es obligatorio"],
      },
      location: {
        type: String,
        required: [true, "La ubicación de la escena es obligatoria"],
      },
      description: {
        type: String,
        required: [true, "La descripción de la escena es obligatoria"],
      },
      characters: [
        {
          name: {
            type: String,
            required: [true, "El nombre del personaje es obligatorio"],
          },
          image_url: {
            type: String,
            required: [
              true,
              "La URL de la imagen del personaje es obligatoria",
            ],
          },
          dialogue: [
            {
              id: {
                type: Number,
                required: [true, "El id del diálogo es obligatorio"],
              },
              text: {
                type: String,
                required: [true, "El texto del diálogo es obligatorio"],
              },
              options: [
                {
                  optionId: {
                    type: Number,
                    required: [true, "El id de la opción es obligatorio"],
                  },
                  text: {
                    type: String,
                    required: [true, "El texto de la opción es obligatorio"],
                  },
                  nextSceneId: {
                    type: Number,
                    required: [
                      true,
                      "El id de la siguiente escena es obligatorio",
                    ],
                  },
                },
              ],
            },
          ],
        },
      ],
      actions: [
        {
          actionId: {
            type: Number,
            required: [true, "El id de la acción es obligatorio"],
          },
          description: {
            type: String,
            required: [true, "La descripción de la acción es obligatoria"],
          },
          nextSceneId: {
            type: Number,
            required: [true, "El id de la siguiente escena es obligatorio"],
          },
        },
      ],
    },
  ],
  playerChoices: {
    affectStory: {
      type: Boolean,
      required: [true, "El efecto en la historia es obligatorio"],
    },
    choicesMade: {
      type: Array,
      required: [true, "Las elecciones del jugador son obligatorias"],
    },
  },
});

GameSchema.methods.toJSON = function () {
  const { __v, ...game } = this.toObject(); //eslint-disable-line
  return game;
};

const Game = model("Game", GameSchema);

module.exports = Game;
